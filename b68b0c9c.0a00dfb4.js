(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{125:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return i})),r.d(t,"metadata",(function(){return o})),r.d(t,"rightToc",(function(){return l})),r.d(t,"default",(function(){return c}));var a=r(1),s=r(6),n=(r(0),r(139)),i={id:"messaging-auth",title:"Authentication",sidebar_label:"Authentication"},o={id:"messaging-auth",title:"Authentication",description:"The authentication protocol is used by a passport that wishes to challenge another passport to securely transmit information such as verified claims or blockchain addresses.\r",source:"@site/..\\docs\\messaging-auth.md",permalink:"/docs/messaging-auth",sidebar_label:"Authentication",sidebar:"gettingStarted",previous:{title:"Bridge Protocol",permalink:"/docs/messaging"},next:{title:"Claims Import",permalink:"/docs/messaging-claimsimport"}},l=[{value:"Creating a Passport Challenge Request",id:"creating-a-passport-challenge-request",children:[]},{value:"Receiving the Passport Challenge Request",id:"receiving-the-passport-challenge-request",children:[]},{value:"Sending the Passport Challenge Response",id:"sending-the-passport-challenge-response",children:[]},{value:"Receiving the Passport Challenge Response",id:"receiving-the-passport-challenge-response",children:[]}],p={rightToc:l};function c(e){var t=e.components,r=Object(s.a)(e,["components"]);return Object(n.b)("wrapper",Object(a.a)({},p,r,{components:t,mdxType:"MDXLayout"}),Object(n.b)("p",null,"The authentication protocol is used by a passport that wishes to challenge another passport to securely transmit information such as verified claims or blockchain addresses."),Object(n.b)("img",{class:"centered",src:"https://github.com/bridge-protocol/bridge-protocol-js/blob/ethereum-publishing/docs/images/message-authchallenge.jpg?raw=true"}),Object(n.b)("h2",{id:"creating-a-passport-challenge-request"},"Creating a Passport Challenge Request"),Object(n.b)("p",null,"A Bridge Passport can challenge another passport for information including the passport identifier, specific claim types, and blockchain addresses."),Object(n.b)("pre",null,Object(n.b)("code",Object(a.a)({parentName:"pre"},{}),'let randomAuthToken = "randomtoken";\nlet requiredClaimTypes = [3];\nlet requiredBlockchainAddresses = ["neo","eth"];\nlet authRequest = await Bridge.Messaging.Auth.createPassportChallengeRequest(passport, password, randomAuthToken, requiredClaimTypes, requiredBlockchainAddresses);\n')),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"randomAuthToken")," - A randomly generated token that will be passed back in the response to assist in verifying the integrity of the response"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"requiredClaimTypes")," - The claim types being requested of the target passport"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"requiredBlockchainAddresses")," - The blockchain network addresses being requested of the target passport"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"authRequest")," - The message payload of the generated challenge request to be sent to the target passport")),Object(n.b)("h2",{id:"receiving-the-passport-challenge-request"},"Receiving the Passport Challenge Request"),Object(n.b)("p",null,"When a passport challenge request message is received, the message and sender passport information need to be verified"),Object(n.b)("pre",null,Object(n.b)("code",Object(a.a)({parentName:"pre"},{}),"let verifiedAuthRequest = await Bridge.Messaging.Auth.verifyPassportChallengeRequest(authRequest);\nlet passportInfo = await Bridge.Services.Passport.getDetails(passport, password, verifiedAuthRequest.passportId);\n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"authRequest")," - the challenge request message received from the sender"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"verifiedAuthRequest")," - the verified challenge request message"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"passportInfo")," - the information received from the Bridge Network about the passport that sent the request message")),Object(n.b)("h2",{id:"sending-the-passport-challenge-response"},"Sending the Passport Challenge Response"),Object(n.b)("p",null,"Once the sender is verified, the passport can retrieve the claim and blockchain address data requested and send generate an encrypted response message with the requested information."),Object(n.b)("pre",null,Object(n.b)("code",Object(a.a)({parentName:"pre"},{}),"let claims = await passport.getDecryptedClaims(verifiedAuthRequest.payload.claimTypes, password);\nlet addresses = passport.getWalletAddresses(verifiedAuthRequest.payload.networks);\nlet authResponse = await Bridge.Messaging.Auth.createPassportChallengeResponse(passport, password, verifiedAuthRequest.publicKey, verifiedAuthRequest.payload.token, claims, addresses); \n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"claims")," - the passport claims to be included in the challenge response"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"addresses")," - the passport blockchain addresses to be included in the challenge response"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"authResponse")," - the challenge response message to be sent back to the requesting passport")),Object(n.b)("h2",{id:"receiving-the-passport-challenge-response"},"Receiving the Passport Challenge Response"),Object(n.b)("p",null,"When the challenge response is received, the message integrity needs to be verified, the message is decrypted, the sender is verified, and the provided claim integrity is verified."),Object(n.b)("pre",null,Object(n.b)("code",Object(a.a)({parentName:"pre"},{}),"let verifiedAuthResponse =  await Bridge.Messaging.Auth.verifyPassportChallengeResponse(passport, password, authResponse, randomAuthToken, requiredClaimTypes, requiredBlockchainAddresses);\nlet passportInfo = await Bridge.Services.Passport.getDetails(passport, password, authResponse.passportId);\n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"authResponse")," - the challenge response message received"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"verifiedAuthResponse")," - the validatated information from the received challenge response message"),Object(n.b)("li",{parentName:"ul"},Object(n.b)("strong",{parentName:"li"},"passportInfo")," - the information received from the Bridge Network about the passport that sent the response message")))}c.isMDXComponent=!0},139:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return b}));var a=r(0),s=r.n(a);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r,a,s={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var p=s.a.createContext({}),c=function(e){var t=s.a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o({},t,{},e)),r},u=function(e){var t=c(e.components);return s.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.a.createElement(s.a.Fragment,{},t)}},h=Object(a.forwardRef)((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(r),h=a,b=u["".concat(i,".").concat(h)]||u[h]||d[h]||n;return r?s.a.createElement(b,o({ref:t},p,{components:r})):s.a.createElement(b,o({ref:t},p))}));function b(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,i=new Array(n);i[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var p=2;p<n;p++)i[p]=r[p];return s.a.createElement.apply(null,i)}return s.a.createElement.apply(null,r)}h.displayName="MDXCreateElement"}}]);